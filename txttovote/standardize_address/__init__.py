__author__ = 'johnlockwood'


ABBREVIATION_REVERSE = {
    'RD': 'Road',
    'ST': 'Street',
    'AVE': 'Avenue',
    'BLVD': 'Boulevard',
    'DR': 'Drive'
}

ABBREVIATION_LOOKUP = {'ALLEE': 'ALY',
 'ALLEY': 'ALY',
 'ALLY': 'ALY',
 'ALY': 'ALY',
 'ANEX': 'ANX',
 'ANNEX': 'ANX',
 'ANX': 'ANX',
 'APARTMENT': 'APT',
 'ARC': 'ARC',
 'ARCADE': 'ARC',
 'AV': 'AVE',
 'AVE': 'AVE',
 'AVEN': 'AVE',
 'AVENU': 'AVE',
 'AVENUE': 'AVE',
 'AVN': 'AVE',
 'AVNUE': 'AVE',
 'BASEMENT': 'BSMT',
 'BAYOO': 'BYU',
 'BAYOU': 'BYU',
 'BCH': 'BCH',
 'BEACH': 'BCH',
 'BEND': 'BND',
 'BLF': 'BLF',
 'BLUF': 'BLF',
 'BLUFF': 'BLF',
 'BLUFFS': 'BLFS',
 'BLVD': 'BLVD',
 'BND': 'BND',
 'BOT': 'BTM',
 'BOTTM': 'BTM',
 'BOTTOM': 'BTM',
 'BOUL': 'BLVD',
 'BOULEVARD': 'BLVD',
 'BOULV': 'BLVD',
 'BR': 'BR',
 'BRANCH': 'BR',
 'BRDGE': 'BRG',
 'BRG': 'BRG',
 'BRIDGE': 'BRG',
 'BRK': 'BRK',
 'BRNCH': 'BR',
 'BROOK': 'BRK',
 'BROOKS': 'BRKS',
 'BTM': 'BTM',
 'BUILDING': 'BLDG',
 'BURG': 'BG',
 'BURGS': 'BGS',
 'BYP': 'BYP',
 'BYPA': 'BYP',
 'BYPAS': 'BYP',
 'BYPASS': 'BYP',
 'BYPS': 'BYP',
 'CAMP': 'CP',
 'CANYN': 'CYN',
 'CANYON': 'CYN',
 'CAPE': 'CPE',
 'CAUSEWAY': 'CSWY',
 'CAUSWAY': 'CSWY',
 'CEN': 'CTR',
 'CENT': 'CTR',
 'CENTER': 'CTR',
 'CENTERS': 'CTRS',
 'CENTR': 'CTR',
 'CENTRE': 'CTR',
 'CIR': 'CIR',
 'CIRC': 'CIR',
 'CIRCL': 'CIR',
 'CIRCLE': 'CIR',
 'CIRCLES': 'CIRS',
 'CK': 'CRK',
 'CLB': 'CLB',
 'CLF': 'CLF',
 'CLFS': 'CLFS',
 'CLIFF': 'CLF',
 'CLIFFS': 'CLFS',
 'CLUB': 'CLB',
 'CMP': 'CP',
 'CNTER': 'CTR',
 'CNTR': 'CTR',
 'CNYN': 'CYN',
 'COMMON': 'CMN',
 'COR': 'COR',
 'CORNER': 'COR',
 'CORNERS': 'CORS',
 'CORS': 'CORS',
 'COURSE': 'CRSE',
 'COURT': 'CT',
 'COURTS': 'CTS',
 'COVE': 'CV',
 'COVES': 'CVS',
 'CP': 'CP',
 'CPE': 'CPE',
 'CR': 'CRK',
 'CRCL': 'CIR',
 'CRCLE': 'CIR',
 'CRECENT': 'CRES',
 'CREEK': 'CRK',
 'CRES': 'CRES',
 'CRESCENT': 'CRES',
 'CRESENT': 'CRES',
 'CREST': 'CRST',
 'CRK': 'CRK',
 'CROSSING': 'XING',
 'CROSSROAD': 'XRD',
 'CRSCNT': 'CRES',
 'CRSE': 'CRSE',
 'CRSENT': 'CRES',
 'CRSNT': 'CRES',
 'CRSSING': 'XING',
 'CRSSNG': 'XING',
 'CRT': 'CT',
 'CSWY': 'CSWY',
 'CT': 'CTS',
 'CTR': 'CTR',
 'CURVE': 'CURV',
 'CV': 'CV',
 'CYN': 'CYN',
 'DALE': 'DL',
 'DAM': 'DM',
 'DEPARTMENT': 'DEPT',
 'DIV': 'DV',
 'DIVIDE': 'DV',
 'DL': 'DL',
 'DM': 'DM',
 'DR': 'DR',
 'DRIV': 'DR',
 'DRIVE': 'DR',
 'DRIVES': 'DRS',
 'DRV': 'DR',
 'DV': 'DV',
 'DVD': 'DV',
 'EST': 'EST',
 'ESTATE': 'EST',
 'ESTATES': 'ESTS',
 'ESTS': 'ESTS',
 'EXP': 'EXPY',
 'EXPR': 'EXPY',
 'EXPRESS': 'EXPY',
 'EXPRESSWAY': 'EXPY',
 'EXPW': 'EXPY',
 'EXPY': 'EXPY',
 'EXT': 'EXT',
 'EXTENSION': 'EXT',
 'EXTENSIONS': 'EXTS',
 'EXTN': 'EXT',
 'EXTNSN': 'EXT',
 'EXTS': 'EXTS',
 'FALL': 'FALL',
 'FALLS': 'FLS',
 'FERRY': 'FRY',
 'FIELD': 'FLD',
 'FIELDS': 'FLDS',
 'FLAT': 'FLT',
 'FLATS': 'FLTS',
 'FLD': 'FLD',
 'FLDS': 'FLDS',
 'FLOOR': 'FL',
 'FLS': 'FLS',
 'FLT': 'FLT',
 'FLTS': 'FLTS',
 'FORD': 'FRD',
 'FORDS': 'FRDS',
 'FOREST': 'FRST',
 'FORESTS': 'FRST',
 'FORG': 'FRG',
 'FORGE': 'FRG',
 'FORGES': 'FRGS',
 'FORK': 'FRK',
 'FORKS': 'FRKS',
 'FORT': 'FT',
 'FRD': 'FRD',
 'FREEWAY': 'FWY',
 'FREEWY': 'FWY',
 'FRG': 'FRG',
 'FRK': 'FRK',
 'FRKS': 'FRKS',
 'FRONT': 'FRNT',
 'FRRY': 'FRY',
 'FRST': 'FRST',
 'FRT': 'FT',
 'FRWAY': 'FWY',
 'FRWY': 'FWY',
 'FRY': 'FRY',
 'FT': 'FT',
 'FWY': 'FWY',
 'GARDEN': 'GDN',
 'GARDENS': 'GDNS',
 'GARDN': 'GDN',
 'GATEWAY': 'GTWY',
 'GATEWY': 'GTWY',
 'GATWAY': 'GTWY',
 'GDN': 'GDN',
 'GDNS': 'GDNS',
 'GLEN': 'GLN',
 'GLENS': 'GLNS',
 'GLN': 'GLN',
 'GRDEN': 'GDN',
 'GRDN': 'GDN',
 'GRDNS': 'GDNS',
 'GREEN': 'GRN',
 'GREENS': 'GRNS',
 'GRN': 'GRN',
 'GROV': 'GRV',
 'GROVE': 'GRV',
 'GROVES': 'GRVS',
 'GRV': 'GRV',
 'GTWAY': 'GTWY',
 'GTWY': 'GTWY',
 'HANGAR': 'HNGR',
 'HARB': 'HBR',
 'HARBOR': 'HBR',
 'HARBORS': 'HBRS',
 'HARBR': 'HBR',
 'HAVEN': 'HVN',
 'HAVN': 'HVN',
 'HBR': 'HBR',
 'HEIGHT': 'HTS',
 'HEIGHTS': 'HTS',
 'HGTS': 'HTS',
 'HIGHWAY': 'HWY',
 'HIGHWY': 'HWY',
 'HILL': 'HL',
 'HILLS': 'HLS',
 'HIWAY': 'HWY',
 'HIWY': 'HWY',
 'HL': 'HL',
 'HLLW': 'HOLW',
 'HLS': 'HLS',
 'HOLLOW': 'HOLW',
 'HOLLOWS': 'HOLW',
 'HOLW': 'HOLW',
 'HOLWS': 'HOLW',
 'HRBOR': 'HBR',
 'HT': 'HTS',
 'HTS': 'HTS',
 'HVN': 'HVN',
 'HWAY': 'HWY',
 'HWY': 'HWY',
 'INLET': 'INLT',
 'INLT': 'INLT',
 'IS': 'IS',
 'ISLAND': 'IS',
 'ISLANDS': 'ISS',
 'ISLE': 'ISLE',
 'ISLES': 'ISLE',
 'ISLND': 'IS',
 'ISLNDS': 'ISS',
 'ISS': 'ISS',
 'JCT': 'JCT',
 'JCTION': 'JCT',
 'JCTN': 'JCT',
 'JCTNS': 'JCTS',
 'JCTS': 'JCTS',
 'JUNCTION': 'JCT',
 'JUNCTIONS': 'JCTS',
 'JUNCTN': 'JCT',
 'JUNCTON': 'JCT',
 'KEY': 'KY',
 'KEYS': 'KYS',
 'KNL': 'KNL',
 'KNLS': 'KNLS',
 'KNOL': 'KNL',
 'KNOLL': 'KNL',
 'KNOLLS': 'KNLS',
 'KY': 'KY',
 'KYS': 'KYS',
 'LA': 'LN',
 'LAKE': 'LK',
 'LAKES': 'LKS',
 'LAND': 'LAND',
 'LANDING': 'LNDG',
 'LANE': 'LN',
 'LANES': 'LN',
 'LCK': 'LCK',
 'LCKS': 'LCKS',
 'LDG': 'LDG',
 'LDGE': 'LDG',
 'LF': 'LF',
 'LGT': 'LGT',
 'LIGHT': 'LGT',
 'LIGHTS': 'LGTS',
 'LK': 'LK',
 'LKS': 'LKS',
 'LN': 'LN',
 'LNDG': 'LNDG',
 'LNDNG': 'LNDG',
 'LOAF': 'LF',
 'LOBBY': 'LBBY',
 'LOCK': 'LCK',
 'LOCKS': 'LCKS',
 'LODG': 'LDG',
 'LODGE': 'LDG',
 'LOOP': 'LOOP',
 'LOOPS': 'LOOP',
 'LOT': 'LOT',
 'LOWER': 'LOWR',
 'MALL': 'MALL',
 'MANOR': 'MNR',
 'MANORS': 'MNRS',
 'MDW': 'MDW',
 'MDWS': 'MDWS',
 'MEADOW': 'MDW',
 'MEADOWS': 'MDWS',
 'MEDOWS': 'MDWS',
 'MEWS': 'MEWS',
 'MILL': 'ML',
 'MILLS': 'MLS',
 'MISSION': 'MSN',
 'MISSN': 'MSN',
 'ML': 'ML',
 'MLS': 'MLS',
 'MNR': 'MNR',
 'MNRS': 'MNRS',
 'MNT': 'MT',
 'MNTAIN': 'MTN',
 'MNTN': 'MTN',
 'MNTNS': 'MTNS',
 'MOTORWAY': 'MTWY',
 'MOUNT': 'MT',
 'MOUNTAIN': 'MTN',
 'MOUNTAINS': 'MTNS',
 'MOUNTIN': 'MTN',
 'MSN': 'MSN',
 'MSSN': 'MSN',
 'MT': 'MT',
 'MTIN': 'MTN',
 'MTN': 'MTN',
 'NCK': 'NCK',
 'NECK': 'NCK',
 'OFFICE': 'OFC',
 'ORCH': 'ORCH',
 'ORCHARD': 'ORCH',
 'ORCHRD': 'ORCH',
 'OVAL': 'OVAL',
 'OVERPASS': 'OPAS',
 'OVL': 'OVAL',
 'PARK': 'PARK',
 'PARKS': 'PARK',
 'PARKWAY': 'PKWY',
 'PARKWAYS': 'PKWY',
 'PARKWY': 'PKWY',
 'PASS': 'PASS',
 'PASSAGE': 'PSGE',
 'PATH': 'PATH',
 'PATHS': 'PATH',
 'PENTHOUSE': 'PH',
 'PIER': 'PIER',
 'PIKE': 'PIKE',
 'PIKES': 'PIKE',
 'PINE': 'PNE',
 'PINES': 'PNES',
 'PK': 'PARK',
 'PKWAY': 'PKWY',
 'PKWY': 'PKWY',
 'PKWYS': 'PKWY',
 'PKY': 'PKWY',
 'PL': 'PL',
 'PLACE': 'PL',
 'PLAIN': 'PLN',
 'PLAINES': 'PLNS',
 'PLAINS': 'PLNS',
 'PLAZA': 'PLZ',
 'PLN': 'PLN',
 'PLNS': 'PLNS',
 'PLZ': 'PLZ',
 'PLZA': 'PLZ',
 'PNES': 'PNES',
 'POINT': 'PT',
 'POINTS': 'PTS',
 'PORT': 'PRT',
 'PORTS': 'PRTS',
 'PR': 'PR',
 'PRAIRIE': 'PR',
 'PRARIE': 'PR',
 'PRK': 'PARK',
 'PRR': 'PR',
 'PRT': 'PRT',
 'PRTS': 'PRTS',
 'PT': 'PT',
 'PTS': 'PTS',
 'RAD': 'RADL',
 'RADIAL': 'RADL',
 'RADIEL': 'RADL',
 'RADL': 'RADL',
 'RAMP': 'RAMP',
 'RANCH': 'RNCH',
 'RANCHES': 'RNCH',
 'RAPID': 'RPD',
 'RAPIDS': 'RPDS',
 'RD': 'RD',
 'RDG': 'RDG',
 'RDGE': 'RDG',
 'RDGS': 'RDGS',
 'RDS': 'RDS',
 'REAR': 'REAR',
 'REST': 'RST',
 'RIDGE': 'RDG',
 'RIDGES': 'RDGS',
 'RIV': 'RIV',
 'RIVER': 'RIV',
 'RIVR': 'RIV',
 'RNCH': 'RNCH',
 'RNCHS': 'RNCH',
 'ROAD': 'RD',
 'ROADS': 'RDS',
 'ROOM': 'RM',
 'ROUTE': 'RTE',
 'ROW': 'ROW',
 'RPD': 'RPD',
 'RPDS': 'RPDS',
 'RST': 'RST',
 'RUE': 'RUE',
 'RUN': 'RUN',
 'RVR': 'RIV',
 'SHL': 'SHL',
 'SHLS': 'SHLS',
 'SHOAL': 'SHL',
 'SHOALS': 'SHLS',
 'SHOAR': 'SHR',
 'SHOARS': 'SHRS',
 'SHORE': 'SHR',
 'SHORES': 'SHRS',
 'SHR': 'SHR',
 'SHRS': 'SHRS',
 'SIDE': 'SIDE',
 'SKYWAY': 'SKWY',
 'SLIP': 'SLIP',
 'SMT': 'SMT',
 'SPACE': 'SPC',
 'SPG': 'SPG',
 'SPGS': 'SPGS',
 'SPNG': 'SPG',
 'SPNGS': 'SPGS',
 'SPRING': 'SPG',
 'SPRINGS': 'SPGS',
 'SPRNG': 'SPG',
 'SPRNGS': 'SPGS',
 'SPUR': 'SPUR',
 'SPURS': 'SPUR',
 'SQ': 'SQ',
 'SQR': 'SQ',
 'SQRE': 'SQ',
 'SQRS': 'SQS',
 'SQU': 'SQ',
 'SQUARE': 'SQ',
 'SQUARES': 'SQS',
 'ST': 'ST',
 'STA': 'STA',
 'STATION': 'STA',
 'STATN': 'STA',
 'STN': 'STA',
 'STOP': 'STOP',
 'STR': 'ST',
 'STRA': 'STRA',
 'STRAV': 'STRA',
 'STRAVE': 'STRA',
 'STRAVEN': 'STRA',
 'STRAVENUE': 'STRA',
 'STRAVN': 'STRA',
 'STREAM': 'STRM',
 'STREET': 'ST',
 'STREETS': 'STS',
 'STREME': 'STRM',
 'STRM': 'STRM',
 'STRT': 'ST',
 'STRVN': 'STRA',
 'STRVNUE': 'STRA',
 'SUITE': 'STE',
 'SUMIT': 'SMT',
 'SUMITT': 'SMT',
 'SUMMIT': 'SMT',
 'TER': 'TER',
 'TERR': 'TER',
 'TERRACE': 'TER',
 'THROUGHWAY': 'TRWY',
 'TPK': 'TPKE',
 'TPKE': 'TPKE',
 'TR': 'TRL',
 'TRACE': 'TRCE',
 'TRACES': 'TRCE',
 'TRACK': 'TRAK',
 'TRACKS': 'TRAK',
 'TRAFFICWAY': 'TRFY',
 'TRAIL': 'TRL',
 'TRAILER': 'TRLR',
 'TRAILS': 'TRL',
 'TRAK': 'TRAK',
 'TRCE': 'TRCE',
 'TRFY': 'TRFY',
 'TRK': 'TRAK',
 'TRKS': 'TRAK',
 'TRL': 'TRL',
 'TRLS': 'TRL',
 'TRNPK': 'TPKE',
 'TRPK': 'TPKE',
 'TUNEL': 'TUNL',
 'TUNL': 'TUNL',
 'TUNLS': 'TUNL',
 'TUNNEL': 'TUNL',
 'TUNNELS': 'TUNL',
 'TUNNL': 'TUNL',
 'TURNPIKE': 'TPKE',
 'TURNPK': 'TPKE',
 'UN': 'UN',
 'UNDERPASS': 'UPAS',
 'UNION': 'UN',
 'UNIONS': 'UNS',
 'UNIT': 'UNIT',
 'UPPER': 'UPPR',
 'VALLEY': 'VLY',
 'VALLEYS': 'VLYS',
 'VALLY': 'VLY',
 'VDCT': 'VIA',
 'VIA': 'VIA',
 'VIADCT': 'VIA',
 'VIADUCT': 'VIA',
 'VIEW': 'VW',
 'VIEWS': 'VWS',
 'VILL': 'VLG',
 'VILLAG': 'VLG',
 'VILLAGE': 'VLG',
 'VILLAGES': 'VLGS',
 'VILLE': 'VL',
 'VILLG': 'VLG',
 'VILLIAGE': 'VLG',
 'VIS': 'VIS',
 'VIST': 'VIS',
 'VISTA': 'VIS',
 'VL': 'VL',
 'VLG': 'VLG',
 'VLGS': 'VLGS',
 'VLLY': 'VLY',
 'VLY': 'VLY',
 'VLYS': 'VLYS',
 'VST': 'VIS',
 'VSTA': 'VIS',
 'VW': 'VW',
 'VWS': 'VWS',
 'WALK': 'WALK',
 'WALKS': 'WALK',
 'WALL': 'WALL',
 'WAY': 'WAY',
 'WAYS': 'WAYS',
 'WELL': 'WL',
 'WELLS': 'WLS',
 'WLS': 'WLS',
 'WY': 'WAY',
 'XING': 'XING'}


def geo_code_key(address_label, zip5):
    return "{0}|{1}".format(zip5, address_label)


def title_case_token(token):
    try:
        title_token = "".join([token[0].upper(), token[1:].lower()])
    except IndexError:
        title_token = token
    return title_token


def title_case_string(a_string):
    if a_string:
        tokens = map(title_case_token, a_string.split(" "))
        return " ".join(tokens)
    return a_string


def standardize_road_type_token(token):
    """Replace a token with standard address abbreviation."""
    upper_token = token.upper()
    return ABBREVIATION_LOOKUP.get(upper_token, upper_token)


def expand_road_type_token(token):
    """Replace a token with expanded address abbreviation."""
    upper_token = token.upper()
    return ABBREVIATION_REVERSE.get(upper_token, title_case_token(token))


def expand_standardize_abbr(address):
    """Replaces parts of address with standardizations."""
    if address:
        abbr_tokens = map(expand_road_type_token, address.split(" "))
        return " ".join(abbr_tokens)


def get_standard_street_type(street_type):
    """
    Standardize a street type such as ALLEY to Aly
    """
    return standardize_road_type_token(street_type).title()


def lookup_standardize_abbr(address):
    """Replaces parts of address with standardizations."""
    if address:
        abbr_tokens = map(standardize_road_type_token, address.split(" "))
        return " ".join(abbr_tokens)
